{% extends 'gv/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% block css %}
<!-- <link rel='stylesheet' type='text/css' href='{% static 'gv/teacher_search/my_teacher_search.css' %}' />
<link rel='stylesheet' type='text/css' href='{% static 'gv/teacher_search/button.css' %}' /> -->
<!--<link rel='stylesheet' type='text/css' href='{% static 'gv/button/table.css' %}' />-->


{% endblock%}

{% block body %}
<!--メインの部分-->
<br>
<img src="/static/gv/teacher_search/images/kyozyubunnseki.png" alt="Re:Re:ss" width="100%"/>
<br>

    <form action='{% url "sub_search" %}' method='post' name='sub_search'>
      {% csrf_token %}
      教科名入力（部分一致可）<br>
            <!-- 入力フォーム -->
            {{form.s_name|add_class:"sub_input"|attr:"autocomplete:off"}}<br>
            <!--<input id="text" type="text" name="pattern" value="" autocomplete="off" size="10" style="display: block">-->
            <!-- 補完候補を表示するエリア -->
            <div id="suggest" class="suggest_input" style="display:none;"></div><br>
            <!-- {{form.t_sub|add_class:"t_sub_input"}}<br> -->
      <button class="hamon">
        授業を検索
      </button>
    </form>
    <div id='t_list'>
      <br>
      <table>
      <thead>
      <tr>
        <th>a</th>
        <th>b</th>
      </tr>
      </thead>
      <tbody>
      {% for message in t_dict %}
      <tr>
        <td>{{message.0}}</td>
        <td>{{ message.1 }}%</td>
      </tr>
      {% endfor %}
      </tbody>
      </table>
      <br>
    </div>

    <div><canvas id="bar-chart"></canvas></div>


{% endblock %}


{% block js %}




<!--**************************************************

****************************************************-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script>
<!--aaaaaaaaaaaaaaaaaaaaa 読み込み中 aaaaaaaaaaaaaaaaa-->
<script src='https://cdn.rawgit.com/jaredreich/notie.js/a9e4afbeea979c0e6ee50aaf5cb4ee80e65d225d/notie.js'></script>


<!--**************************************************
               棒グラフの記述
****************************************************-->
<script language="JavaScript">
  var nums = {{nums|safe}};
  var grade_list_sample = {{grade_list_sample|safe}};
  var r_form = '{{r_form|safe}}'
  var ctx = document.getElementById("bar-chart").getContext('2d');
  ctx.canvas.height = 280;
  var ChartDemo = new Chart(ctx, {
         type: 'bar',
         data: {
            //labels: kind_list,
            labels: grade_list_sample,
            datasets: [
            {
            label: r_form,
            lineTension: 0,
            fill: false,
            //backgroundColor: ["rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(246,133,124,0.5)","rgba(246,133,124,0.5)","rgba(206,195,73,0.5)"]
            backgroundColor: "rgba(131,90,206,0.4)",
            //borderColor: "#217346",
            data: nums
          },
            ]
         },
         options: {
            responsive: true,
            legend: {
              labels: {
                fontSize:13,
                boxWidth: 10,
              }
            },
            scales: {
          xAxes: [{
            ticks: {
              fontSize: 15,
              maxRotation: 100,
              minRotation: 0
            },
          }],
          yAxes: [{
            ticks: {
              fontSize: 10,
              beginAtZero:true,
              min: 0,
              callback: function(value) {if (value % 1 === 0) {return value+'人';}}
            },
          }],
        },
         }
       });
</script>

<!--入力補完-->
<script src='{% static "gv/teacher_search/suggest.js" %}'></script>
<script>
  var all_sub_list = {{all_sub_list|safe}};
  function startSuggest() {
    new Suggest.Local(
          "id_s_name",    // 入力のエレメントID
          "suggest", // 補完候補を表示するエリアのID
          all_sub_list,      // 補完候補の検索対象となる配列
          {dispMax: 10, interval: 1000}); // オプション
  }

  window.addEventListener ?
    window.addEventListener('load', startSuggest, false) :
    window.attachEvent('onload', startSuggest);
</script>

{% endblock %}
