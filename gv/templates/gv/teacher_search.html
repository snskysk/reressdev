{% extends 'gv/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% block css %}
<link rel='stylesheet' type='text/css' href='{% static 'gv/teacher_search/my_teacher_search.css' %}' />


{% endblock%}

{% block body %}
<!--メインの部分-->
  <h1 class="page-header" style="text-align:center;">先生の成績</h1>

  <br>


  <!--<form action='{% url 'teacher_search' %}' method='post' name='teacher_search' onsubmit="return false;">-->
    <form action='{% url 'teacher_search' %}' method='post' name='teacher_search'>
    {% csrf_token %}
    <table>
      <tr>
        <td>入力:</td>
        <td>
          <!-- 入力フォーム -->
          {{form.t_name|attr:"autocomplete:off"}}
          <!--<input id="text" type="text" name="pattern" value="" autocomplete="off" size="10" style="display: block">-->
          <!-- 補完候補を表示するエリア -->
          <div id="suggest" style="display:none;"></div>
        </td>
      </tr>
    </table>
    <button class="detail_button">
      先生を探す
    </button>
  </form>




  <br>

  <div>
    <div><canvas id="bar-chart"></canvas></div>
  </div>

{% endblock %}


{% block js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script>

<!--**************************************************
               棒グラフの記述
****************************************************-->
<script language="JavaScript">
  var p = {{p|safe}};
  var grade_list_sample = {{grade_list_sample|safe}};
  var ctx = document.getElementById("bar-chart").getContext('2d');
  ctx.canvas.height = 280;
  var ChartDemo = new Chart(ctx, {
         type: 'bar',
         data: {
            //labels: kind_list,
            labels: grade_list_sample,
            datasets: [
            {
            label: "確率",
            lineTension: 0,
            fill: false,
            //backgroundColor: ["rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(131,185,206,0.5)","rgba(246,133,124,0.5)","rgba(246,133,124,0.5)","rgba(206,195,73,0.5)"]
            backgroundColor: "rgba(131,90,206,0.5)",
            //borderColor: "#217346",
            data: p
          },
            ]
         },
         options: {
            responsive: true,
            legend: {
              labels: {
                fontSize: 7,
                boxWidth: 20,
              }
            },
            scales: {
          xAxes: [{
            ticks: {
              fontSize: 7,
              maxRotation: 100,
              minRotation: 0
            },
          }],
          yAxes: [{
            ticks: {
              fontSize: 18,
              beginAtZero:true,
              min: 0,
              max: 100,
            },
          }],
        },
         }
       });
</script>


<!--入力補完-->
<script src='{% static 'gv/teacher_search/suggest.js' %}'></script>
<script>
var teacher_list = {{teacher_list|safe}};
function startSuggest() {
  new Suggest.Local(
        "id_t_name",    // 入力のエレメントID
        "suggest", // 補完候補を表示するエリアのID
        teacher_list,      // 補完候補の検索対象となる配列
        {dispMax: 10, interval: 1000}); // オプション
}

window.addEventListener ?
  window.addEventListener('load', startSuggest, false) :
  window.attachEvent('onload', startSuggest);
</script>
{% endblock %}
